<ng-container *ngIf="toolbarState$ | async as state">
  <div
    *ngIf="state?.show"
    class="floating-toolbar"
    [ngStyle]="{
      top: state?.position?.top + 'px',
      left: state?.position?.left + 'px'
    }"
  >
    <!-- Text Formatting Tools -->
    <div
      *ngIf="state?.isTextSelection"
      class="toolbar-group"
    >
      <button
        class="toolbar-button"
        (click)="handleAction('format', 'bold')"
        aria-label="Bold text"
      >
        <svg
          xmlns="http://www.w3.org/2000/svg"
          width="16"
          height="16"
          viewBox="0 0 24 24"
          fill="none"
          stroke="currentColor"
          stroke-width="2"
          stroke-linecap="round"
          stroke-linejoin="round"
        >
          <path d="M6 4h8a4 4 0 0 1 4 4 4 4 0 0 1-4 4H6z"/>
          <path d="M6 12h9a4 4 0 0 1 4 4 4 4 0 0 1-4 4H6z"/>
        </svg>
      </button>

      <button
        class="toolbar-button"
        (click)="handleAction('format', 'italic')"
        aria-label="Italicize text"
      >
        <svg
          xmlns="http://www.w3.org/2000/svg"
          width="16"
          height="16"
          viewBox="0 0 24 24"
          fill="none"
          stroke="currentColor"
          stroke-width="2"
          stroke-linecap="round"
          stroke-linejoin="round"
        >
          <line x1="19" y1="4" x2="10" y2="4"/>
          <line x1="14" y1="20" x2="5" y2="20"/>
          <line x1="15" y1="4" x2="9" y2="20"/>
        </svg>
      </button>
    </div>

    <!-- Image Tools -->
    <div
      *ngIf="state?.isImageSelected"
      class="toolbar-group"
    >
      <button
        class="toolbar-button"
        (click)="handleAction('image', 'options')"
        aria-label="Image options"
      >
        Image Options
      </button>
    </div>

    <!-- Code Block Tools -->
    <div
      *ngIf="state?.isCodeBlock"
      class="toolbar-group"
    >
      <button
        class="toolbar-button"
        (click)="handleAction('code', 'theme')"
        aria-label="Change code theme"
      >
        <svg
          xmlns="http://www.w3.org/2000/svg"
          width="16"
          height="16"
          viewBox="0 0 24 24"
          fill="none"
          stroke="currentColor"
          stroke-width="2"
          stroke-linecap="round"
          stroke-linejoin="round"
        >
          <path d="M12 2L2 7l10 5 10-5-10-5zM2 17l10 5 10-5M2 12l10 5 10-5"/>
        </svg>
        Change Theme
      </button>

      <button
        class="toolbar-button"
        (click)="handleAction('code', 'copy')"
        aria-label="Copy code"
      >
        <svg
          xmlns="http://www.w3.org/2000/svg"
          width="16"
          height="16"
          viewBox="0 0 24 24"
          fill="none"
          stroke="currentColor"
          stroke-width="2"
          stroke-linecap="round"
          stroke-linejoin="round"
        >
          <path d="M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"/>
          <rect x="8" y="2" width="8" height="4" rx="1" ry="1"/>
        </svg>
        Copy
      </button>
    </div>
  </div>
</ng-container>
